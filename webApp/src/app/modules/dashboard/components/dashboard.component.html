<section class="row dashboard-cards mt-3" *ngIf="appUser$ | async as appUser">
  <div class="col-sm-6 col-md-4 col-xl-3 mb-xs-3">
    <organisms-card class="user-card">
      <atoms-profile-pic [avatar]="appUser.avatar"></atoms-profile-pic>
      <ul>
        <li>
          <h5>{{ appUser.fullname }}</h5>
          <span>({{ appUser.login }})</span>
        </li>
        <li *ngIf="appUser.Department">
          <atoms-link-button
            [linkLabel]="appUser.Department.title"
            linkType="router"
            linkHref="/departments/details/{{ appUser.Department.id }}"
          ></atoms-link-button>
        </li>
        <li class="roles" *ngIf="appUser.Roles">
          <span *ngFor="let role of appUser.Roles; last as isLast">{{ role.keyString }}</span>
        </li>
      </ul>
    </organisms-card>
  </div>

  <div class="col-sm-6 col-md-4 col-xl-3 mb-xs-3">
    <organisms-card cardTitle="Session data" class="user-card">
      <ul class="sessionData">
        <li *ngIf="appUser.PasswordAttributes && appUser.PasswordAttributes.passwordExpire">
          <div>
            <small i18n="@@dashboardCardsUserPasswordExpireDate">Password expire date:</small
            ><small>{{ appUser.PasswordAttributes.passwordExpire | date: 'medium' }}</small>
          </div>
        </li>
        <li *ngIf="appUser.PasswordAttributes && appUser.PasswordAttributes.updatedAt">
          <div>
            <small i18n="@@dashboardCardsUserPasswordUpdatedDate">Last password update:</small
            ><small>{{ appUser.PasswordAttributes.updatedAt | date: 'medium' }}</small>
          </div>
        </li>
        <li *ngIf="appUser.lastSessionData && appUser.lastSessionData.dateLastLoggedIn">
          <div>
            <small i18n="@@dashboardCardsUserDateLastLoggedIn">Last session:</small
            ><small>{{ appUser.lastSessionData.dateLastLoggedIn | date: 'medium' }}</small>
          </div>
        </li>
        <li *ngIf="appUser.lastSessionData && appUser.lastSessionData.dateUnsuccessfulLogIn">
          <div>
            <small i18n="@@dashboardCardsUserDateUnsuccessfulLogIn">Unsuccessful login:</small
            ><small>{{ appUser.lastSessionData.dateUnsuccessfulLogIn | date: 'medium' }}</small>
          </div>
        </li>
      </ul>
    </organisms-card>
  </div>

  <div class="col-sm-12 col-md-6 col-xl-6" *ngIf="(rolesChartData$ | async).length > 0">
    <organisms-card cardTitle="Roles">
      <molecules-chart
        chartType="bar-vertical"
        paramX="keyString"
        paramY="Users"
        [results]="rolesChartData$ | async"
        scheme="aqua"
        [gradient]="true"
        [xAxis]="true"
        [yAxis]="true"
        [legend]="false"
        [showXAxisLabel]="true"
        [showYAxisLabel]="true"
        xAxisLabel="Roles"
        yAxisLabel="Number of users"
      >
      </molecules-chart>
    </organisms-card>
  </div>
</section>

<section class="row my-3">
  <div class="col-sm-12 col-md-6 col-xl-6 mb-xs-3" *ngIf="(planStagesChartData$ | async).length > 0">
    <organisms-card cardTitle="Plans by stage">
      <molecules-chart
        chartType="advanced-pie-chart"
        paramX="keyString"
        paramY="Plans"
        [results]="planStagesChartData$ | async"
        scheme="natural"
        [gradient]="true"
      >
      </molecules-chart>
    </organisms-card>
  </div>

  <div class="col-sm-12 col-md-6 col-xl-6" *ngIf="(departmentsChartData$ | async).length > 0">
    <organisms-card cardTitle="Departments">
      <molecules-chart
        chartType="bar-vertical"
        paramX="title"
        paramY="Workers"
        [results]="departmentsChartData$ | async"
        scheme="natural"
        [gradient]="true"
        [xAxis]="true"
        [yAxis]="true"
        [legend]="false"
        [showXAxisLabel]="true"
        [showYAxisLabel]="true"
        xAxisLabel="Departments"
        yAxisLabel="Number of workers"
      >
      </molecules-chart>
    </organisms-card>
  </div>
</section>
