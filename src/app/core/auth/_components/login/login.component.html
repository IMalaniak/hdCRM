<section class="login-section" >
  <h3 class="crm-brand">Crm company</h3>
  <div class="row">
    <div class="col col-md">
      <form (submit)="onLoginSubmit()" *ngIf="currentPath === 'login'">
        <mat-card>
          <mat-card-content class="d-flex justify-content-center flex-column p-3">
            <h3 i18n="@@loginComponentFormHeaderTitleLogin" class="pb-2">Login</h3>
            <mat-card class="failed-message mb-3" *ngIf="serverResponse && !serverResponse.success">
              <mat-card-content class="d-flex flex-row align-items-center">
                <mat-icon>highlight_off</mat-icon>
                <div class="ml-3">
                  <span i18n="@@loginComponentMessageTokenIsNotValid">Your token does not exist or it has expired.</span>
                </div>
              </mat-card-content>
            </mat-card>
            <mat-form-field appearance="outline">
              <mat-label i18n="@@loginComponentFormLoginOrEmailLabel">Login/Email</mat-label>
              <input matInput [(ngModel)]="user.login" name="login" autocomplete="username" type="text" required>
            </mat-form-field>
            <mat-form-field appearance="outline">
              <mat-label i18n="@@loginComponentFormPasswordLabel">Password</mat-label>
              <input matInput [(ngModel)]="user.password" name="password" autocomplete="current-password" [type]="hidePassword ? 'password' : 'text'" required>
              <mat-icon matSuffix (click)="hidePassword = !hidePassword">{{hidePassword ? 'visibility_off' : 'visibility'}}</mat-icon>
            </mat-form-field>  
            <button mat-raised-button color="primary" class="crm-button mb-3" type="submit"><mat-icon>vpn_key</mat-icon><span i18n="@@loginComponentFormActionsLogIn">Login</span></button>
            <button mat-button type="button" class="text-muted mx-auto" routerLink="/auth/request-new-password/" i18n="@@loginComponentActionsForgotYourPassword">Forgot password</button>
          </mat-card-content>
        </mat-card>
      </form>
      <form (submit)="onResetPasswordRequest()" *ngIf="currentPath === 'request-new-password'">
        <mat-card>
          <mat-card-content class="d-flex justify-content-center flex-column p-3">
            <h3 i18n="@@loginComponentFormRequestNewPasswordHeader" class="pb-2">Your email or login</h3>
            <mat-card class="success-message mb-3" *ngIf="serverResponse && serverResponse.success">
              <mat-card-content class="d-flex flex-row align-items-center">
                <mat-icon>check_circle_outline</mat-icon>
                <div class="ml-3">
                  <span i18n="@@loginComponentMessageSentToYourEmailAddress">A message has been sent to your email address. Follow the instructions to reset your password.</span>
                </div>
              </mat-card-content>
            </mat-card>
            <mat-card class="failed-message mb-3" *ngIf="serverResponse && !serverResponse.success">
              <mat-card-content class="d-flex flex-row align-items-center">
                <mat-icon>highlight_off</mat-icon>
                <div class="ml-3">
                  <span i18n="@@loginComponentMessageUserIsNotExist">The following user does not exist! Please, provide correct email or login!</span>
                </div>
              </mat-card-content>
            </mat-card>
            <mat-form-field appearance="outline">
              <mat-label i18n="@@loginComponentFormLoginOrEmailLabel">Login/Email</mat-label>
              <input matInput [(ngModel)]="user.login" type="text" autocomplete="username" name="login" required>
            </mat-form-field>
            <div class="d-flex justify-content-between">
              <button mat-raised-button class="crm-button mr-1" type="reset" routerLink="/auth/login"><mat-icon>clear</mat-icon><span i18n="@@globalActionsCancelEdit">Cancel</span></button>
              <button mat-raised-button color="primary" class="crm-button ml-1" type="submit"><mat-icon>arrow_forward</mat-icon><span i18n="@@loginComponentActionsResetPassword">Reset password</span></button>
            </div>
          </mat-card-content>
        </mat-card>
      </form>
      <form (submit)="onResetPassword()" [formGroup]="newPasswordForm" *ngIf="currentPath === 'password-reset'">
        <mat-card>
          <mat-card-content class="d-flex justify-content-center flex-column p-3">
            <h3 i18n="@@loginComponentFormPasswordResetHeader" class="pb-2">Reset password</h3>
            <mat-card class="success-message mb-3" *ngIf="serverResponse && serverResponse.success">
              <mat-card-content class="d-flex flex-row align-items-center">
                <mat-icon>check_circle_outline</mat-icon>
                <div class="ml-3">
                  <span i18n="@@loginComponentMessagePasswordChanged">You have successfully changed your password.</span>
                </div>
              </mat-card-content>
            </mat-card>
            <mat-card class="failed-message mb-3" *ngIf="serverResponse && !serverResponse.success">
              <mat-card-content class="d-flex flex-row align-items-center">
                <mat-icon>highlight_off</mat-icon>
                <div class="ml-3">
                  <span i18n="@@loginComponentMessageTokenIsNotValid">Your token does not exist or it has expired.<br>You can <a routerLink="/auth/request-new-password/">request a new password reset</a></span>
                </div>
              </mat-card-content>
            </mat-card>
            <mat-form-field appearance="outline">
              <mat-label i18n="@@loginComponentFormResetNewPasswordLabel">New password</mat-label>
              <input matInput type="password" formControlName="newPassword" autocomplete="off" [type]="hidePassword ? 'password' : 'text'" required>
              <mat-icon matSuffix (click)="hidePassword = !hidePassword">{{hidePassword ? 'visibility_off' : 'visibility'}}</mat-icon>
              <mat-error *ngIf="newPassword.invalid">
                <mat-error *ngIf="newPassword.errors.minlength" i18n="@@loginComponentInputErrorsPasswordIsTooShort">
                  Password is too short!
                </mat-error>
                <mat-error *ngIf="newPassword.errors.required" i18n="@@loginComponentdInputErrorsPasswordRequired">
                  Password is reqired!
                </mat-error>
                <mat-error *ngIf="newPassword.errors.maxlength" i18n="@@loginComponentInputErrorsPasswordIsTooLong">
                  Password is too long!
                </mat-error>
              </mat-error>
            </mat-form-field>
            <mat-form-field appearance="outline">
              <mat-label i18n="@@loginComponentFormResetConfirmPasswordLabel">Confirm password</mat-label>
              <input matInput type="password" formControlName="confirmPassword" required>
              <mat-error *ngIf="confirmPassword.invalid">
                <mat-error *ngIf="confirmPassword.errors.ConfirmPassword && (confirmPassword.dirty || confirmPassword.touched)" i18n="@@loginComponentInputErrorsPasswordsDoesNotMatch">
                  Passwords does not match!
                </mat-error>
                <mat-error *ngIf="confirmPassword.errors.required" i18n="@@loginComponentInputErrorsConfirmPasswordRequired">
                  Password is reqired!
                </mat-error>
              </mat-error>
            </mat-form-field> 
            <div class="d-flex flex-row justify-content-between mt-1">
              <button mat-stroked-button class="crm-button mr-1" routerLink="/auth/login"><mat-icon>clear</mat-icon><span i18n="@@globalActionsCancelEdit">Cancel</span></button>
              <button mat-raised-button color="primary" type="submit" class="crm-button ml-1" [disabled]="newPasswordForm.invalid"><mat-icon>done</mat-icon><span i18n="@@loginComponentFormActionsSubmit">Submit</span></button>
            </div> 
          </mat-card-content>
        </mat-card>
      </form>
      <mat-card *ngIf="currentPath === 'activate-account'">
        <mat-card-content class="d-flex justify-content-center flex-column p-3">
          <mat-card class="process-message" *ngIf="!serverResponse">
            <mat-card-content class="d-flex flex-row align-items-center">
              <mat-icon>check_circle_outline</mat-icon>
              <div class="ml-3">
                <span i18n="@@loginComponentMessageActivationInProgress">Wait until your account is been activated...</span>
              </div>
            </mat-card-content>
          </mat-card>
          <mat-card class="success-message" *ngIf="serverResponse && serverResponse.success">
            <mat-card-content class="d-flex flex-row align-items-center">
              <mat-icon>check_circle_outline</mat-icon>
              <div class="ml-3">
                <span i18n="@@loginComponentMessageAccountActivated">You account has been activated successfully! You can <a routerLink="/auth/">login now</a>.</span>
              </div>
            </mat-card-content>
          </mat-card>
          <mat-card class="failed-message" *ngIf="serverResponse && !serverResponse.success">
            <mat-card-content class="d-flex flex-row align-items-center">
              <mat-icon>highlight_off</mat-icon>
              <div class="ml-3">
                <span i18n="@@loginComponentMessageTokenIsNotValid">Your token does not exist or it has expired.</span>
              </div>
            </mat-card-content>
          </mat-card>
        </mat-card-content>   
      </mat-card>
    </div>
  </div>
</section>

